<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HyperFixi i18n - Live Test</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    .header {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      margin-bottom: 30px;
    }
    .header h1 {
      color: #333;
      margin-bottom: 10px;
    }
    .header p {
      color: #666;
      font-size: 14px;
    }
    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
    }
    .test-card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .test-card h3 {
      color: #333;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #667eea;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .test-card h3 .flag {
      font-size: 24px;
    }
    .code-block {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 15px;
      border-radius: 6px;
      margin: 10px 0;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
    }
    .code-block .keyword {
      color: #66d9ef;
    }
    .code-block .event {
      color: #a6e22e;
    }
    .code-block .command {
      color: #f92672;
    }
    .code-block .selector {
      color: #e6db74;
    }
    .demo-area {
      margin-top: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }
    .demo-button {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.3s ease;
      margin: 5px;
    }
    .demo-button.toggle-demo {
      background: #667eea;
      color: white;
    }
    .demo-button.toggle-demo.active {
      background: #28a745;
      transform: scale(1.1);
    }
    .demo-button.toggle-demo:hover {
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    .demo-button.counter-btn {
      background: #764ba2;
      color: white;
    }
    .demo-button.counter-btn:hover {
      background: #5a3a80;
    }
    .counter-display {
      font-size: 48px;
      font-weight: bold;
      text-align: center;
      padding: 20px;
      color: #333;
    }
    .status {
      padding: 10px;
      border-radius: 4px;
      margin-top: 10px;
      font-size: 13px;
    }
    .status.success {
      background: #d4edda;
      color: #155724;
      border-left: 4px solid #28a745;
    }
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border-left: 4px solid #dc3545;
    }
    .status.pending {
      background: #fff3cd;
      color: #856404;
      border-left: 4px solid #ffc107;
    }
    .loading-indicator {
      text-align: center;
      padding: 40px;
      color: white;
      font-size: 18px;
    }
    .controls {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .controls button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      margin-right: 10px;
    }
    .controls button:hover {
      background: #5568d3;
    }
    .summary {
      display: flex;
      gap: 20px;
      margin-top: 15px;
    }
    .stat {
      padding: 10px 20px;
      background: #f8f9fa;
      border-radius: 6px;
    }
    .stat-number {
      font-size: 24px;
      font-weight: bold;
    }
    .stat-number.pass { color: #28a745; }
    .stat-number.fail { color: #dc3545; }
    .stat-label {
      font-size: 12px;
      color: #666;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸŒ HyperFixi i18n - Live Test</h1>
      <p>Testing multilingual hyperscript keyword providers in the browser</p>
    </div>

    <div class="controls">
      <button onclick="runAllTests()">â–¶ï¸ Run All Tests</button>
      <button onclick="runProviderTests()">ğŸ”¤ Test Providers</button>
      <div class="summary">
        <div class="stat">
          <div class="stat-number pass" id="pass-count">-</div>
          <div class="stat-label">PASSED</div>
        </div>
        <div class="stat">
          <div class="stat-number fail" id="fail-count">-</div>
          <div class="stat-label">FAILED</div>
        </div>
      </div>
    </div>

    <div id="loading" class="loading-indicator">
      Loading bundles...
    </div>

    <div id="test-container" class="test-grid" style="display: none;">
      <!-- Spanish Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡ªğŸ‡¸</span> Spanish (EspaÃ±ol)</h3>
        <div class="code-block">
          <span class="keyword">en</span> <span class="event">clic</span> <span class="command">alternar</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="es-toggle">Click to Toggle (Spanish)</button>
        </div>
        <div class="status pending" id="es-status">Waiting for test...</div>
      </div>

      <!-- Japanese Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡¯ğŸ‡µ</span> Japanese (æ—¥æœ¬èª)</h3>
        <div class="code-block">
          <span class="keyword">ã§</span> <span class="event">ã‚¯ãƒªãƒƒã‚¯</span> <span class="command">åˆ‡ã‚Šæ›¿ãˆ</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="ja-toggle">Click to Toggle (Japanese)</button>
        </div>
        <div class="status pending" id="ja-status">Waiting for test...</div>
      </div>

      <!-- French Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡«ğŸ‡·</span> French (FranÃ§ais)</h3>
        <div class="code-block">
          <span class="keyword">sur</span> <span class="event">clic</span> <span class="command">basculer</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="fr-toggle">Click to Toggle (French)</button>
        </div>
        <div class="status pending" id="fr-status">Waiting for test...</div>
      </div>

      <!-- German Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡©ğŸ‡ª</span> German (Deutsch)</h3>
        <div class="code-block">
          <span class="keyword">bei</span> <span class="event">klick</span> <span class="command">umschalten</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="de-toggle">Click to Toggle (German)</button>
        </div>
        <div class="status pending" id="de-status">Waiting for test...</div>
      </div>

      <!-- Arabic Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡¸ğŸ‡¦</span> Arabic (Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</h3>
        <div class="code-block" dir="rtl" style="text-align: right;">
          <span class="keyword">Ø¹Ù†Ø¯</span> <span class="event">Ù†Ù‚Ø±</span> <span class="command">Ø¨Ø¯Ù„</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="ar-toggle">Click to Toggle (Arabic)</button>
        </div>
        <div class="status pending" id="ar-status">Waiting for test...</div>
      </div>

      <!-- Korean Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡°ğŸ‡·</span> Korean (í•œêµ­ì–´)</h3>
        <div class="code-block">
          <span class="keyword">ì—</span> <span class="event">í´ë¦­</span> <span class="command">í† ê¸€</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="ko-toggle">Click to Toggle (Korean)</button>
        </div>
        <div class="status pending" id="ko-status">Waiting for test...</div>
      </div>

      <!-- Chinese Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡¨ğŸ‡³</span> Chinese (ä¸­æ–‡)</h3>
        <div class="code-block">
          <span class="keyword">å½“</span> <span class="event">ç‚¹å‡»</span> <span class="command">åˆ‡æ¢</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="zh-toggle">Click to Toggle (Chinese)</button>
        </div>
        <div class="status pending" id="zh-status">Waiting for test...</div>
      </div>

      <!-- Turkish Tests -->
      <div class="test-card">
        <h3><span class="flag">ğŸ‡¹ğŸ‡·</span> Turkish (TÃ¼rkÃ§e)</h3>
        <div class="code-block">
          <span class="keyword">Ã¼zerinde</span> <span class="event">tÄ±klama</span> <span class="command">deÄŸiÅŸtir</span> <span class="selector">.active</span>
        </div>
        <div class="demo-area">
          <button class="demo-button toggle-demo" id="tr-toggle">Click to Toggle (Turkish)</button>
        </div>
        <div class="status pending" id="tr-status">Waiting for test...</div>
      </div>
    </div>
  </div>

  <!-- Load HyperFixi Core -->
  <script src="../core/dist/hyperfixi-browser.js"></script>

  <!-- Load i18n Bundle -->
  <script src="./dist/hyperfixi-i18n.min.js"></script>

  <script>
    // Test results tracking
    let passCount = 0;
    let failCount = 0;

    function updateCounts() {
      document.getElementById('pass-count').textContent = passCount;
      document.getElementById('fail-count').textContent = failCount;
    }

    function setStatus(locale, success, message) {
      const el = document.getElementById(`${locale}-status`);
      el.className = `status ${success ? 'success' : 'error'}`;
      el.textContent = message;
      if (success) passCount++; else failCount++;
      updateCounts();
    }

    // Test provider resolution
    function testProviderResolution(locale, provider, tests) {
      try {
        for (const [input, expected] of tests) {
          const result = provider.resolve(input);
          if (result !== expected) {
            setStatus(locale, false, `Failed: ${input} â†’ ${result} (expected ${expected})`);
            return false;
          }
        }
        setStatus(locale, true, `âœ“ All keyword resolutions correct`);
        return true;
      } catch (e) {
        setStatus(locale, false, `Error: ${e.message}`);
        return false;
      }
    }

    function runProviderTests() {
      passCount = 0;
      failCount = 0;

      // Reset all statuses
      document.querySelectorAll('.status').forEach(el => {
        el.className = 'status pending';
        el.textContent = 'Testing...';
      });

      const i18n = window.HyperFixiI18n;

      // Test Spanish
      testProviderResolution('es', i18n.esKeywords, [
        ['alternar', 'toggle'],
        ['en', 'on'],
        ['clic', 'click'],
        ['toggle', 'toggle'], // English fallback
      ]);

      // Test Japanese
      testProviderResolution('ja', i18n.jaKeywords, [
        ['åˆ‡ã‚Šæ›¿ãˆ', 'toggle'],
        ['ã§', 'on'],
        ['ã‚¯ãƒªãƒƒã‚¯', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test French
      testProviderResolution('fr', i18n.frKeywords, [
        ['basculer', 'toggle'],
        ['sur', 'on'],
        ['clic', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test German
      testProviderResolution('de', i18n.deKeywords, [
        ['umschalten', 'toggle'],
        ['bei', 'on'],
        ['klick', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test Arabic
      testProviderResolution('ar', i18n.arKeywords, [
        ['Ø¨Ø¯Ù„', 'toggle'],
        ['Ø¹Ù†Ø¯', 'on'],
        ['Ù†Ù‚Ø±', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test Korean
      testProviderResolution('ko', i18n.koKeywords, [
        ['í† ê¸€', 'toggle'],
        ['ì—', 'on'],
        ['í´ë¦­', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test Chinese
      testProviderResolution('zh', i18n.zhKeywords, [
        ['åˆ‡æ¢', 'toggle'],
        ['ç‚¹å‡»', 'click'],
        ['toggle', 'toggle'],
      ]);

      // Test Turkish
      testProviderResolution('tr', i18n.trKeywords, [
        ['deÄŸiÅŸtir', 'toggle'],
        ['Ã¼zerinde', 'on'],
        ['tÄ±klama', 'click'],
        ['toggle', 'toggle'],
      ]);
    }

    function runAllTests() {
      runProviderTests();
    }

    // Initialize on load
    window.addEventListener('DOMContentLoaded', () => {
      // Check if bundles loaded
      const loading = document.getElementById('loading');
      const container = document.getElementById('test-container');

      if (typeof window.hyperfixi === 'undefined') {
        loading.textContent = 'âŒ Error: HyperFixi core bundle not loaded';
        loading.style.color = '#dc3545';
        return;
      }

      if (typeof window.HyperFixiI18n === 'undefined') {
        loading.textContent = 'âŒ Error: HyperFixi i18n bundle not loaded';
        loading.style.color = '#dc3545';
        return;
      }

      // Bundles loaded successfully
      loading.style.display = 'none';
      container.style.display = 'grid';

      console.log('âœ“ HyperFixi core loaded:', window.hyperfixi);
      console.log('âœ“ HyperFixi i18n loaded:', window.HyperFixiI18n);
      console.log('Available providers:', Object.keys(window.HyperFixiI18n).filter(k => k.endsWith('Keywords')));

      // Auto-run tests
      setTimeout(runAllTests, 100);
    });
  </script>
</body>
</html>
