<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dialog Toggle - HyperFixi Examples</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      padding: 20px;
      line-height: 1.6;
    }

    h1 {
      color: #2563eb;
      border-bottom: 2px solid #dbeafe;
      padding-bottom: 10px;
    }

    h2 {
      color: #1e40af;
      margin-top: 30px;
    }

    .example {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }

    .example h3 {
      margin-top: 0;
      color: #334155;
    }

    button {
      background: #3b82f6;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin: 5px;
    }

    button:hover {
      background: #2563eb;
    }

    button.secondary {
      background: #64748b;
    }

    button.secondary:hover {
      background: #475569;
    }

    button.danger {
      background: #ef4444;
    }

    button.danger:hover {
      background: #dc2626;
    }

    dialog {
      border: none;
      border-radius: 12px;
      padding: 0;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      min-width: 400px;
    }

    dialog::backdrop {
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
    }

    .dialog-header {
      background: #f1f5f9;
      padding: 20px;
      border-bottom: 1px solid #e2e8f0;
    }

    .dialog-header h3 {
      margin: 0;
      color: #1e293b;
    }

    .dialog-body {
      padding: 20px;
    }

    .dialog-footer {
      background: #f8fafc;
      padding: 15px 20px;
      border-top: 1px solid #e2e8f0;
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .code {
      background: #1e293b;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      overflow-x: auto;
      margin: 10px 0;
    }

    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 10px;
    }

    .badge.default {
      background: #dbeafe;
      color: #1e40af;
    }

    .badge.modal {
      background: #fef3c7;
      color: #92400e;
    }

    .demo-content {
      background: white;
      padding: 15px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      margin: 10px 0;
    }

    .status {
      font-size: 14px;
      color: #64748b;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Dialog Toggle Examples</h1>
  <p>Demonstrating smart dialog detection and toggle functionality in HyperFixi.</p>

  <!-- Example 1: Basic Non-Modal Dialog (Default) -->
  <div class="example">
    <h3>1. Non-Modal Dialog (Default) <span class="badge default">show()</span></h3>
    <p>Default behavior uses <code>show()</code> for non-modal dialogs. Page remains interactive.</p>

    <div class="code">
&lt;button _="on click toggle #infoDialog"&gt;Toggle Info&lt;/button&gt;

&lt;dialog id="infoDialog"&gt;
  &lt;button _="on click toggle #infoDialog"&gt;Close&lt;/button&gt;
&lt;/dialog&gt;
    </div>

    <div class="demo-content">
      <button _="on click toggle #infoDialog">Toggle Info Dialog</button>
      <p class="status">Try clicking outside the dialog - page stays interactive!</p>
    </div>
  </div>

  <dialog id="infoDialog">
    <div class="dialog-header">
      <h3>‚ÑπÔ∏è Information</h3>
    </div>
    <div class="dialog-body">
      <p>This is a non-modal dialog opened with <code>show()</code>.</p>
      <p>You can still interact with the page behind this dialog.</p>
      <p><strong>Notice:</strong> No backdrop, no focus trap.</p>
    </div>
    <div class="dialog-footer">
      <button class="secondary" _="on click toggle #infoDialog">Close Dialog</button>
    </div>
  </dialog>

  <!-- Example 2: Modal Dialog -->
  <div class="example">
    <h3>2. Modal Dialog <span class="badge modal">showModal()</span></h3>
    <p>Use <code>modal</code> parameter to open with <code>showModal()</code>. Blocks page interaction.</p>

    <div class="code">
&lt;button _="on click toggle #confirmDialog modal"&gt;Open Modal&lt;/button&gt;

&lt;dialog id="confirmDialog"&gt;
  &lt;button _="on click toggle #confirmDialog"&gt;Close&lt;/button&gt;
&lt;/dialog&gt;
    </div>

    <div class="demo-content">
      <button _="on click toggle #confirmDialog modal">Open Confirmation Modal</button>
      <p class="status">Modal dialogs block interaction with the page and have a backdrop.</p>
    </div>
  </div>

  <dialog id="confirmDialog">
    <div class="dialog-header">
      <h3>‚ö†Ô∏è Confirm Action</h3>
    </div>
    <div class="dialog-body">
      <p>This is a modal dialog opened with <code>showModal()</code>.</p>
      <p><strong>Notice the backdrop</strong> and try clicking outside.</p>
      <p>Press ESC to close, or use the buttons below.</p>
    </div>
    <div class="dialog-footer">
      <button class="secondary" _="on click toggle #confirmDialog">Cancel</button>
      <button class="danger" _="on click toggle #confirmDialog then log 'Confirmed!'">Confirm</button>
    </div>
  </dialog>

  <!-- Example 3: Form Dialog -->
  <div class="example">
    <h3>3. Form Dialog with Submission</h3>
    <p>Dialog with a form that closes on submit.</p>

    <div class="code">
&lt;button _="on click toggle #formDialog modal"&gt;Open Form&lt;/button&gt;

&lt;dialog id="formDialog"&gt;
  &lt;form _="on submit
            halt the event
            then toggle #formDialog
            then log 'Form submitted: ' + my.name.value"&gt;
    &lt;input name="name" required&gt;
    &lt;button type="submit"&gt;Submit&lt;/button&gt;
  &lt;/form&gt;
&lt;/dialog&gt;
    </div>

    <div class="demo-content">
      <button _="on click toggle #formDialog modal">Open Form Dialog</button>
      <p class="status">Form submission closes the dialog automatically.</p>
    </div>
  </div>

  <dialog id="formDialog">
    <div class="dialog-header">
      <h3>üìù User Form</h3>
    </div>
    <form _="on submit
              halt the event
              then toggle #formDialog
              then log 'Form submitted with name: ' + my.name.value">
      <div class="dialog-body">
        <label for="userName" style="display: block; margin-bottom: 5px;">Name:</label>
        <input
          type="text"
          id="userName"
          name="name"
          required
          style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">

        <label for="userEmail" style="display: block; margin-top: 15px; margin-bottom: 5px;">Email:</label>
        <input
          type="email"
          id="userEmail"
          name="email"
          required
          style="width: 100%; padding: 8px; border: 1px solid #e2e8f0; border-radius: 4px;">
      </div>
      <div class="dialog-footer">
        <button type="button" class="secondary" _="on click toggle #formDialog">Cancel</button>
        <button type="submit">Submit Form</button>
      </div>
    </form>
  </dialog>

  <!-- Example 4: Multiple Dialogs -->
  <div class="example">
    <h3>4. Multiple Dialogs</h3>
    <p>Toggle multiple dialogs independently.</p>

    <div class="demo-content">
      <button _="on click toggle #dialog1 modal">Open Dialog 1</button>
      <button _="on click toggle #dialog2">Open Dialog 2 (non-modal)</button>
      <p class="status">Each dialog can be toggled independently.</p>
    </div>
  </div>

  <dialog id="dialog1">
    <div class="dialog-header">
      <h3>Dialog 1 (Modal)</h3>
    </div>
    <div class="dialog-body">
      <p>This is the first modal dialog.</p>
      <p>You can open another dialog from here:</p>
      <button _="on click toggle #dialog2">Open Dialog 2</button>
    </div>
    <div class="dialog-footer">
      <button class="secondary" _="on click toggle #dialog1">Close</button>
    </div>
  </dialog>

  <dialog id="dialog2">
    <div class="dialog-header">
      <h3>Dialog 2 (Non-Modal)</h3>
    </div>
    <div class="dialog-body">
      <p>This is the second dialog (non-modal by default).</p>
      <p>Notice you can still interact with other elements!</p>
    </div>
    <div class="dialog-footer">
      <button class="secondary" _="on click toggle #dialog2">Close</button>
    </div>
  </dialog>

  <!-- Example 5: Chaining Actions -->
  <div class="example">
    <h3>5. Chaining with Other Actions</h3>
    <p>Toggle dialogs and chain with other hyperscript commands.</p>

    <div class="code">
&lt;button _="on click
            toggle #chainDialog modal
            then add .pulse to me"&gt;
  Open & Pulse
&lt;/button&gt;
    </div>

    <div class="demo-content">
      <button _="on click
                  toggle #chainDialog modal
                  then wait 100ms
                  then log 'Dialog toggled!'">
        Open with Logging
      </button>
      <p class="status" id="chainStatus">Status: Ready</p>
    </div>
  </div>

  <dialog id="chainDialog">
    <div class="dialog-header">
      <h3>üîó Chained Actions</h3>
    </div>
    <div class="dialog-body">
      <p>This dialog was opened with chained actions!</p>
      <p>Check the browser console for the log message.</p>
    </div>
    <div class="dialog-footer">
      <button class="secondary"
              _="on click
                toggle #chainDialog
                then put 'Dialog closed!' into #chainStatus">
        Close with Update
      </button>
    </div>
  </dialog>

  <hr style="margin: 40px 0; border: none; border-top: 2px solid #e2e8f0;">

  <h2>Summary</h2>
  <div class="example">
    <h3>Syntax Reference</h3>
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="background: #f1f5f9;">
          <th style="padding: 10px; text-align: left; border: 1px solid #e2e8f0;">Syntax</th>
          <th style="padding: 10px; text-align: left; border: 1px solid #e2e8f0;">Method</th>
          <th style="padding: 10px; text-align: left; border: 1px solid #e2e8f0;">Behavior</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>toggle #myDialog</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>show()</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;">Non-modal (default, safer)</td>
        </tr>
        <tr style="background: #f8fafc;">
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>toggle #myDialog modal</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>showModal()</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;">Modal (blocks page)</td>
        </tr>
        <tr>
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>toggle #myDialog</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;"><code>close()</code></td>
          <td style="padding: 10px; border: 1px solid #e2e8f0;">Close dialog (from inside or outside)</td>
        </tr>
      </tbody>
    </table>

    <h3 style="margin-top: 20px;">Key Points</h3>
    <ul>
      <li><strong>Default is non-modal:</strong> <code>toggle #dialog</code> uses <code>show()</code></li>
      <li><strong>Explicit modal:</strong> Add <code>modal</code> parameter for <code>showModal()</code></li>
      <li><strong>Backward compatible:</strong> Class/attribute toggle still works on dialogs</li>
      <li><strong>Accessibility:</strong> Non-modal is safer for screen readers</li>
      <li><strong>Smart detection:</strong> Automatically detects <code>&lt;dialog&gt;</code> elements</li>
    </ul>
  </div>

  <!-- Load HyperFixi -->
  <script src="../../dist/hyperfixi-browser.js"></script>
  <script>
    console.log('HyperFixi loaded with dialog toggle support!');
    console.log('Try opening the dialogs and watch for events in the console.');

    // Add event listeners to log dialog events
    document.querySelectorAll('dialog').forEach(dialog => {
      dialog.addEventListener('hyperscript:toggle', (e) => {
        console.log('Dialog toggled:', {
          id: dialog.id,
          mode: e.detail.mode,
          state: e.detail.state,
          type: e.detail.type
        });
      });
    });
  </script>
</body>
</html>
