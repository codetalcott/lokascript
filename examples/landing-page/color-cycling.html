<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Landing Page Example: Color Cycling</title>
  <link rel="stylesheet" href="../gallery.css">
  <style>
    /* Example-specific styles */
    #color-box {
      width: 350px;
      height: 250px;
      background: hsl(200, 100%, 90%);
      border: 3px solid #333;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: #333;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      margin: 0 auto;
    }

    .instructions {
      background: var(--tag-default-bg);
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      color: var(--tag-default-color);
      font-weight: 500;
    }

    #status {
      margin-top: 20px;
      padding: 10px;
      border-radius: 4px;
      text-align: center;
      font-weight: bold;
    }

    #status.ready {
      background: var(--success-bg);
      color: #155724;
    }

    #status.cycling {
      background: #fff3cd;
      color: #856404;
    }

    #status.error {
      background: #f8d7da;
      color: #721c24;
    }
  </style>
</head>
<body class="example-page">
  <div class="page-container">
    <div class="breadcrumb">
      <a href="../index.html">&larr; Back to Gallery</a> / <strong>Landing Page</strong> / Color Cycling
    </div>

    <h1>Hyperscript Landing Page Example</h1>

    <div class="description">
      <strong>Exact example from hyperscript.org landing page</strong><br>
      This tests the bundle's ability to handle the color cycling demo exactly as shown on the official site.
    </div>

    <div class="demo">
      <div class="instructions">
        Press and hold the box below. Watch the colors cycle while you hold! Release to stop.
      </div>

      <!-- EXACT code from hyperscript landing page (now supported!) -->
      <div id="color-box"
           _="on pointerdown
                repeat until event pointerup from the document
                  set rand to Math.random() * 360
                  transition
                    *background-color
                    to `hsl($rand 100% 90%)`
                    over 250ms
                end
                transition *background-color to initial">
        Press & Hold Me!
      </div>

      <div id="status" class="ready">Ready - Press and hold the box</div>
    </div>

    <h2>The Exact Code</h2>
    <div class="code">_="on pointerdown
  repeat until event pointerup from the document
    set rand to Math.random() * 360
    transition
      *background-color
      to `hsl($rand 100% 90%)`
      over 250ms
  end
  transition *background-color to initial"</div>

    <h2>Features Tested</h2>
    <ul>
      <li><code>on pointerdown</code> - Pointer event handling</li>
      <li><code>repeat until event pointerup from the document</code> - Event-driven loop with global event source</li>
      <li><code>set rand to Math.random() * 360</code> - JavaScript global access and arithmetic</li>
      <li><code>*background-color</code> - CSS property access (possessive style syntax)</li>
      <li><code>`hsl($rand 100% 90%)`</code> - Template string with variable interpolation</li>
      <li><code>over 250ms</code> - Transition timing</li>
      <li><code>to initial</code> - CSS initial value keyword</li>
    </ul>
  </div>

  <!-- Load HyperFixi -->
  <script src="../../packages/core/dist/hyperfixi-browser.js"></script>
  <script src="../debug-panel.js"></script>
  <script>
    // Track cycling state for testing
    const colorBox = document.getElementById('color-box');
    const status = document.getElementById('status');
    let cycleCount = 0;

    colorBox.addEventListener('pointerdown', () => {
      status.className = 'cycling';
      status.textContent = 'Cycling colors...';
      cycleCount = 0;
    });

    document.addEventListener('pointerup', () => {
      status.className = 'ready';
      status.textContent = `Ready - Completed ${cycleCount} color cycles`;
    });

    // Count transitions for testing
    colorBox.addEventListener('transitionend', () => {
      cycleCount++;
    });

    // Error handling
    window.onerror = (msg) => {
      status.className = 'error';
      status.textContent = `Error: ${msg}`;
    };
  </script>
</body>
</html>
