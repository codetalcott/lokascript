<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>htmx-like: History Navigation Example</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
    .demo-box { border: 1px solid #ccc; padding: 20px; margin: 20px 0; border-radius: 8px; }
    button { padding: 8px 16px; margin: 5px; cursor: pointer; }
    .info { background: #f0f9ff; padding: 10px; border-radius: 4px; margin: 10px 0; }
    .page-nav { display: flex; gap: 10px; margin-bottom: 20px; }
    .page-nav button { background: #f0f0f0; border: 1px solid #ccc; }
    .page-nav button.active { background: #007bff; color: white; border-color: #007bff; }
    #history-content { min-height: 150px; padding: 20px; background: #fafafa; border-radius: 8px; }
    .url-display { font-family: monospace; background: #e0e0e0; padding: 5px 10px; border-radius: 4px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>History Navigation Example</h1>

  <div class="info">
    <strong>Purpose:</strong> Demonstrates hypermedia navigation with server-fetched fragments,
    <code>push url</code> / <code>replace url</code> commands, and the <code>HistorySwap</code> behavior
    for handling browser back/forward.
    <div class="url-display">Current URL: <span id="current-url"></span></div>
  </div>

  <h2>Navigation with Push URL</h2>

  <div class="page-nav">
    <button id="nav-home" class="active" _="on click
      remove .active from <button/> in closest .page-nav
      add .active to me
      fetch '/examples/htmx-like/fragments/home.html' as html
      swap innerHTML of #history-content with it
      push url '/examples/htmx-like/fragments/home.html'
    ">Home</button>

    <button id="nav-products" _="on click
      remove .active from <button/> in closest .page-nav
      add .active to me
      fetch '/examples/htmx-like/fragments/products.html' as html
      swap innerHTML of #history-content with it
      push url '/examples/htmx-like/fragments/products.html'
    ">Products</button>

    <button id="nav-about" _="on click
      remove .active from <button/> in closest .page-nav
      add .active to me
      fetch '/examples/htmx-like/fragments/about.html' as html
      swap innerHTML of #history-content with it
      push url '/examples/htmx-like/fragments/about.html'
    ">About</button>

    <button id="nav-contact" _="on click
      remove .active from <button/> in closest .page-nav
      add .active to me
      fetch '/examples/htmx-like/fragments/contact.html' as html
      swap innerHTML of #history-content with it
      push url '/examples/htmx-like/fragments/contact.html'
    ">Contact</button>
  </div>

  <div id="history-content" _="
    on load
      install HistorySwap(target: me, strategy: 'innerHTML')
    end
  ">
    <h3>Home</h3>
    <p>Welcome to the home page!</p>
  </div>

  <h2>Replace URL (No History Entry)</h2>

  <div class="demo-box">
    <p>Replace URL updates the URL without creating a history entry (can't go back):</p>
    <button _="on click
      fetch '/examples/htmx-like/fragments/filter.html' as html
      swap innerHTML of #history-content with it
      replace url '/examples/htmx-like/fragments/filter.html'
    ">Apply Filter (replace)</button>

    <button _="on click
      fetch '/examples/htmx-like/fragments/sort-date.html' as html
      swap innerHTML of #history-content with it
      replace url '/examples/htmx-like/fragments/sort-date.html'
    ">Sort by Date (replace)</button>
  </div>

  <script src="../../packages/core/dist/hyperfixi-browser.js"></script>
  <script src="../debug-panel.js"></script>
  <script>
    // Update URL display
    function updateUrlDisplay() {
      document.getElementById('current-url').textContent = window.location.pathname;
    }
    updateUrlDisplay();

    // Listen for URL changes
    window.addEventListener('popstate', updateUrlDisplay);
  </script>
</body>
</html>
